!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.squooshCore=e():n.squooshCore=e()}(this,(function(){return function(n){var e={};function r(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return n[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=n,r.c=e,r.d=function(n,e,t){r.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},r.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,e){if(1&e&&(n=r(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)r.d(t,o,function(e){return n[e]}.bind(null,o));return t},r.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(e,"a",e),e},r.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},r.p="",r(r.s=0)}([function(n,e,r){"use strict";r.r(e),r.d(e,"compress",(function(){return Q}));var t={};r.r(t),r.d(t,"label",(function(){return A})),r.d(t,"mimeType",(function(){return T})),r.d(t,"extension",(function(){return x})),r.d(t,"defaultOptions",(function(){return P})),r.d(t,"encode",(function(){return E}));var o={};r.r(o),r.d(o,"label",(function(){return B})),r.d(o,"mimeType",(function(){return z})),r.d(o,"extension",(function(){return H})),r.d(o,"defaultOptions",(function(){return q})),r.d(o,"encode",(function(){return N}));var i=function(n,e,r,t){return new(r||(r=Promise))((function(o,i){function a(n){try{c(t.next(n))}catch(n){i(n)}}function u(n){try{c(t.throw(n))}catch(n){i(n)}}function c(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,u)}c((t=t.apply(n,e||[])).next())}))},a=function(n,e){var r,t,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=function(n){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&n[e],t=0;if(r)return r.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&t>=n.length&&(n=void 0),{value:n&&n[t++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(n,e){var r="function"==typeof Symbol&&n[Symbol.iterator];if(!r)return n;var t,o,i=r.call(n),a=[];try{for(;(void 0===e||e-- >0)&&!(t=i.next()).done;)a.push(t.value)}catch(n){o={error:n}}finally{try{t&&!t.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};function f(n,e){return n({noInitialRun:!0,locateFile:function(n){if(n.endsWith(".wasm"))return e;throw Error("Unknown url in locateFile "+n)}})}function s(n,e,r){return i(this,void 0,void 0,(function(){var t,o,i,u,c,f,s,l,p;return a(this,(function(a){switch(a.label){case 0:if((t=document.createElement("canvas")).width=n.width,t.height=n.height,!(o=t.getContext("2d")))throw Error("Canvas not initialized");return o.putImageData(n,0,0),"toBlob"in t?[4,new Promise((function(n){return t.toBlob(n,e,r)}))]:[3,2];case 1:return i=a.sent(),[3,3];case 2:if(u=t.toDataURL(e,r),!(c=/data:([^;]+);base64,(.*)$/.exec(u)))throw Error("Data URL reading failed");for(f=c[1],s=atob(c[2]),l=new Uint8Array(s.length),p=0;p<l.length;p+=1)l[p]=s.charCodeAt(p);i=new Blob([l],{type:f}),a.label=3;case 3:if(!i)throw Error("Encoding failed");return[2,i]}}))}))}function l(n){return i(this,void 0,void 0,(function(){var e,r;return a(this,(function(t){switch(t.label){case 0:return(e=new Image).decoding="async",e.src=n,r=new Promise((function(n,r){e.onload=function(){return n(e)},e.onerror=function(){return r(Error("Image loading error"))}})),e.decode?[4,e.decode().catch((function(){return null}))]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,r];case 3:return t.sent(),[2,e]}}))}))}new Map;function p(n){return new Response(n).arrayBuffer()}var h=new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"],[/^\xF4\xFF\x6F/,"image/webp2"],[/^\x00\x00\x00 ftypavif\x00\x00\x00\x00/,"image/avif"],[/^\xff\x0a/,"image/jpegxl"]]);function d(n){return i(this,void 0,void 0,(function(){var e,r,t,o,i,f,s,l,d;return a(this,(function(a){switch(a.label){case 0:return[4,p(n.slice(0,16))];case 1:e=a.sent(),r=Array.from(new Uint8Array(e)).map((function(n){return String.fromCodePoint(n)})).join("");try{for(t=u(h),o=t.next();!o.done;o=t.next())if(i=c(o.value,2),f=i[0],s=i[1],f.test(r))return[2,s]}catch(n){l={error:n}}finally{try{o&&!o.done&&(d=t.return)&&d.call(t)}finally{if(l)throw l.error}}return[2,""]}}))}))}function y(n){return i(this,void 0,void 0,(function(){var e;return a(this,(function(r){switch(r.label){case 0:e=URL.createObjectURL(n),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,l(e)];case 2:return[2,r.sent()];case 3:return URL.revokeObjectURL(e),[7];case 4:return[2]}}))}))}function v(n,e){void 0===e&&(e={});var r=e.width,t=void 0===r?n.width:r,o=e.height,i=void 0===o?n.height:o,a=e.sx,u=void 0===a?0:a,c=e.sy,f=void 0===c?0:c,s=e.sw,l=void 0===s?n.width:s,p=e.sh,h=void 0===p?n.height:p,d=document.createElement("canvas");d.width=t,d.height=i;var y=d.getContext("2d");if(!y)throw new Error("Could not create canvas context");return y.drawImage(n,u,f,l,h,0,0,t,i),y.getImageData(0,0,t,i)}function m(n){return i(this,void 0,void 0,(function(){var e;return a(this,(function(r){switch(r.label){case 0:return"createImageBitmap"in self?[4,createImageBitmap(n)]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,y(n)];case 3:e=r.sent(),r.label=4;case 4:return[2,v(e)]}}))}))}var g,w=function(n){var e,r,t;n=n||{},e||(e=void 0!==n?n:{}),e.ready=new Promise((function(n,e){r=n,t=e}));var o,i={};for(o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);var a="./this.program";function u(n,e){throw e}var c,f="";f=0!==(f=self.location.href).indexOf("blob:")?f.substr(0,f.lastIndexOf("/")+1):"",c=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)};var s,l,p=e.print||console.log.bind(console),h=e.printErr||console.warn.bind(console);for(o in i)i.hasOwnProperty(o)&&(e[o]=i[o]);i=null,e.thisProgram&&(a=e.thisProgram),e.quit&&(u=e.quit),e.wasmBinary&&(s=e.wasmBinary),e.noExitRuntime&&(l=e.noExitRuntime),"object"!=typeof WebAssembly&&L("no native wasm support detected");var d,y,v,m,g,w,b,_,A,T,x=!1,P=new TextDecoder("utf8"),E=new TextDecoder("utf-16le");function W(n,e){var r=n>>1;for(e=r+e/2;!(r>=e)&&w[r];)++r;return E.decode(m.subarray(n,r<<1))}function k(n,e,r){if(void 0===r&&(r=2147483647),2>r)return 0;var t=e;r=(r-=2)<2*n.length?r/2:n.length;for(var o=0;o<r;++o)g[e>>1]=n.charCodeAt(o),e+=2;return g[e>>1]=0,e-t}function C(n){return 2*n.length}function F(n,e){for(var r=0,t="";!(r>=e/4);){var o=b[n+4*r>>2];if(0==o)break;++r,65536<=o?(o-=65536,t+=String.fromCharCode(55296|o>>10,56320|1023&o)):t+=String.fromCharCode(o)}return t}function R(n,e,r){if(void 0===r&&(r=2147483647),4>r)return 0;var t=e;r=t+r-4;for(var o=0;o<n.length;++o){var i=n.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&n.charCodeAt(++o)),b[e>>2]=i,(e+=4)+4>r)break}return b[e>>2]=0,e-t}function I(n){for(var e=0,r=0;r<n.length;++r){var t=n.charCodeAt(r);55296<=t&&57343>=t&&++r,e+=4}return e}function S(n){y=n,e.HEAP8=v=new Int8Array(n),e.HEAP16=g=new Int16Array(n),e.HEAP32=b=new Int32Array(n),e.HEAPU8=m=new Uint8Array(n),e.HEAPU16=w=new Uint16Array(n),e.HEAPU32=_=new Uint32Array(n),e.HEAPF32=A=new Float32Array(n),e.HEAPF64=T=new Float64Array(n)}var O=e.INITIAL_MEMORY||16777216;(d=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:O/65536,maximum:32768}))&&(y=d.buffer),O=y.byteLength,S(y);var U,j=[],M=[],D=[],B=[];function z(){var n=e.preRun.shift();j.unshift(n)}var H=0,q=null,N=null;function L(n){throw e.onAbort&&e.onAbort(n),h(n),x=!0,n=new WebAssembly.RuntimeError("abort("+n+"). Build with -s ASSERTIONS=1 for more info."),t(n),n}function G(){var n=V;return String.prototype.startsWith?n.startsWith("data:application/octet-stream;base64,"):0===n.indexOf("data:application/octet-stream;base64,")}e.preloadedImages={},e.preloadedAudios={};var V="mozjpeg_enc.wasm";if(!G()){var J=V;V=e.locateFile?e.locateFile(J,f):f+J}function K(){try{if(s)return new Uint8Array(s);if(c)return c(V);throw"both async and sync fetching of the wasm failed"}catch(n){L(n)}}function $(n){for(;0<n.length;){var r=n.shift();if("function"==typeof r)r(e);else{var t=r.R;"number"==typeof t?void 0===r.L?U.get(t)():U.get(t)(r.L):t(void 0===r.L?null:r.L)}}}var X={};function Y(n){for(;n.length;){var e=n.pop();n.pop()(e)}}function Z(n){return this.fromWireType(_[n>>2])}var Q={},nn={},en={};function rn(n){if(void 0===n)return"_unknown";var e=(n=n.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=e&&57>=e?"_"+n:n}function tn(n,e){return n=rn(n),new Function("body","return function "+n+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(e)}function on(n){var e=Error,r=tn(n,(function(e){this.name=n,this.message=e,void 0!==(e=Error(e).stack)&&(this.stack=this.toString()+"\n"+e.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var an=void 0;function un(n,e,r){function t(e){if((e=r(e)).length!==n.length)throw new an("Mismatched type converter count");for(var t=0;t<n.length;++t)hn(n[t],e[t])}n.forEach((function(n){en[n]=e}));var o=Array(e.length),i=[],a=0;e.forEach((function(n,e){nn.hasOwnProperty(n)?o[e]=nn[n]:(i.push(n),Q.hasOwnProperty(n)||(Q[n]=[]),Q[n].push((function(){o[e]=nn[n],++a===i.length&&t(o)})))})),0===i.length&&t(o)}function cn(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}var fn=void 0;function sn(n){for(var e="";m[n];)e+=fn[m[n++]];return e}var ln=void 0;function pn(n){throw new ln(n)}function hn(n,e,r){if(r=r||{},!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var t=e.name;if(n||pn('type "'+t+'" must have a positive integer typeid pointer'),nn.hasOwnProperty(n)){if(r.V)return;pn("Cannot register type '"+t+"' twice")}nn[n]=e,delete en[n],Q.hasOwnProperty(n)&&(e=Q[n],delete Q[n],e.forEach((function(n){n()})))}var dn=[],yn=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function vn(n){4<n&&0==--yn[n].M&&(yn[n]=void 0,dn.push(n))}function mn(n){switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var e=dn.length?dn.pop():yn.length;return yn[e]={M:1,value:n},e}}function gn(n){if(null===n)return"null";var e=typeof n;return"object"===e||"array"===e||"function"===e?n.toString():""+n}function wn(n,e){switch(e){case 2:return function(n){return this.fromWireType(A[n>>2])};case 3:return function(n){return this.fromWireType(T[n>>3])};default:throw new TypeError("Unknown float type: "+n)}}function bn(n,r,t){e.hasOwnProperty(n)?((void 0===t||void 0!==e[n].J&&void 0!==e[n].J[t])&&pn("Cannot register public name '"+n+"' twice"),function(n,r){var t=e;if(void 0===t[n].J){var o=t[n];t[n]=function(){return t[n].J.hasOwnProperty(arguments.length)||pn("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[n].J+")!"),t[n].J[arguments.length].apply(this,arguments)},t[n].J=[],t[n].J[o.O]=o}}(n,n),e.hasOwnProperty(t)&&pn("Cannot register multiple overloads of a function with the same number of arguments ("+t+")!"),e[n].J[t]=r):(e[n]=r,void 0!==t&&(e[n].ba=t))}function _n(n,r){var t=-1!=(n=sn(n)).indexOf("j")?function(n,r){0<=n.indexOf("j")||L("Assertion failed: getDynCaller should only be called with i64 sigs");var t=[];return function(){t.length=arguments.length;for(var o=0;o<arguments.length;o++)t[o]=arguments[o];return-1!=n.indexOf("j")?t&&t.length?e["dynCall_"+n].apply(null,[r].concat(t)):e["dynCall_"+n].call(null,r):U.get(r).apply(null,t)}}(n,r):U.get(r);return"function"!=typeof t&&pn("unknown function pointer with signature "+n+": "+r),t}var An=void 0;function Tn(n){var e=sn(n=zn(n));return Dn(n),e}function xn(n,e,r){switch(e){case 0:return r?function(n){return v[n]}:function(n){return m[n]};case 1:return r?function(n){return g[n>>1]}:function(n){return w[n>>1]};case 2:return r?function(n){return b[n>>2]}:function(n){return _[n>>2]};default:throw new TypeError("Unknown integer type: "+n)}}var Pn={};function En(){return"object"==typeof globalThis?globalThis:Function("return this")()}function Wn(n,e){var r=nn[n];return void 0===r&&pn(e+" has unknown type "+Tn(n)),r}var kn={},Cn={};function Fn(){if(!Rn){var n,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:a||"./this.program"};for(n in Cn)e[n]=Cn[n];var r=[];for(n in e)r.push(n+"="+e[n]);Rn=r}return Rn}var Rn,In=[null,[],[]];an=e.InternalError=on("InternalError");for(var Sn=Array(256),On=0;256>On;++On)Sn[On]=String.fromCharCode(On);fn=Sn,ln=e.BindingError=on("BindingError"),e.count_emval_handles=function(){for(var n=0,e=5;e<yn.length;++e)void 0!==yn[e]&&++n;return n},e.get_first_emval=function(){for(var n=5;n<yn.length;++n)if(void 0!==yn[n])return yn[n];return null},An=e.UnboundTypeError=on("UnboundTypeError"),M.push({R:function(){Mn()}});var Un={B:function(){},o:function(n){var e=X[n];delete X[n];var r=e.W,t=e.X,o=e.N;un([n],o.map((function(n){return n.U})).concat(o.map((function(n){return n.Z}))),(function(n){var i={};return o.forEach((function(e,r){var t=n[r],a=e.S,u=e.T,c=n[r+o.length],f=e.Y,s=e.$;i[e.P]={read:function(n){return t.fromWireType(a(u,n))},write:function(n,e){var r=[];f(s,n,c.toWireType(r,e)),Y(r)}}})),[{name:e.name,fromWireType:function(n){var e,r={};for(e in i)r[e]=i[e].read(n);return t(n),r},toWireType:function(n,e){for(var o in i)if(!(o in e))throw new TypeError('Missing field:  "'+o+'"');var a=r();for(o in i)i[o].write(a,e[o]);return null!==n&&n.push(t,a),a},argPackAdvance:8,readValueFromPointer:Z,K:t}]}))},y:function(n,e,r,t,o){var i=cn(r);hn(n,{name:e=sn(e),fromWireType:function(n){return!!n},toWireType:function(n,e){return e?t:o},argPackAdvance:8,readValueFromPointer:function(n){if(1===r)var t=v;else if(2===r)t=g;else{if(4!==r)throw new TypeError("Unknown boolean type size: "+e);t=b}return this.fromWireType(t[n>>i])},K:null})},x:function(n,e){hn(n,{name:e=sn(e),fromWireType:function(n){var e=yn[n].value;return vn(n),e},toWireType:function(n,e){return mn(e)},argPackAdvance:8,readValueFromPointer:Z,K:null})},k:function(n,e,r){r=cn(r),hn(n,{name:e=sn(e),fromWireType:function(n){return n},toWireType:function(n,e){if("number"!=typeof e&&"boolean"!=typeof e)throw new TypeError('Cannot convert "'+gn(e)+'" to '+this.name);return e},argPackAdvance:8,readValueFromPointer:wn(e,r),K:null})},g:function(n,r,t,o,i,a){var u=function(n,e){for(var r=[],t=0;t<n;t++)r.push(b[(e>>2)+t]);return r}(r,t);n=sn(n),i=_n(o,i),bn(n,(function(){!function(n,e){var r=[],t={};throw e.forEach((function n(e){t[e]||nn[e]||(en[e]?en[e].forEach(n):(r.push(e),t[e]=!0))})),new An(n+": "+r.map(Tn).join([", "]))}("Cannot call "+n+" due to unbound types",u)}),r-1),un([],u,(function(t){var o=n,u=n;t=[t[0],null].concat(t.slice(1));var c=i,f=t.length;2>f&&pn("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=null!==t[1]&&!1,l=!1,p=1;p<t.length;++p)if(null!==t[p]&&void 0===t[p].K){l=!0;break}var h="void"!==t[0].name,d="",y="";for(p=0;p<f-2;++p)d+=(0!==p?", ":"")+"arg"+p,y+=(0!==p?", ":"")+"arg"+p+"Wired";u="return function "+rn(u)+"("+d+") {\nif (arguments.length !== "+(f-2)+") {\nthrowBindingError('function "+u+" called with ' + arguments.length + ' arguments, expected "+(f-2)+" args!');\n}\n",l&&(u+="var destructors = [];\n");var v=l?"destructors":"null";for(d="throwBindingError invoker fn runDestructors retType classParam".split(" "),c=[pn,c,a,Y,t[0],t[1]],s&&(u+="var thisWired = classParam.toWireType("+v+", this);\n"),p=0;p<f-2;++p)u+="var arg"+p+"Wired = argType"+p+".toWireType("+v+", arg"+p+"); // "+t[p+2].name+"\n",d.push("argType"+p),c.push(t[p+2]);if(s&&(y="thisWired"+(0<y.length?", ":"")+y),u+=(h?"var rv = ":"")+"invoker(fn"+(0<y.length?", ":"")+y+");\n",l)u+="runDestructors(destructors);\n";else for(p=s?1:2;p<t.length;++p)f=1===p?"thisWired":"arg"+(p-2)+"Wired",null!==t[p].K&&(u+=f+"_dtor("+f+"); // "+t[p].name+"\n",d.push(f+"_dtor"),c.push(t[p].K));if(h&&(u+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),d.push(u+"}\n"),t=function(n){var e=Function;if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=tn(e.name||"unknownFunctionName",(function(){}));return r.prototype=e.prototype,r=new r,(n=e.apply(r,n))instanceof Object?n:r}(d).apply(null,c),p=r-1,!e.hasOwnProperty(o))throw new an("Replacing nonexistant public symbol");return void 0!==e[o].J&&void 0!==p?e[o].J[p]=t:(e[o]=t,e[o].O=p),[]}))},d:function(n,e,r,t,o){function i(n){return n}e=sn(e),-1===o&&(o=4294967295);var a=cn(r);if(0===t){var u=32-8*r;i=function(n){return n<<u>>>u}}var c=-1!=e.indexOf("unsigned");hn(n,{name:e,fromWireType:i,toWireType:function(n,r){if("number"!=typeof r&&"boolean"!=typeof r)throw new TypeError('Cannot convert "'+gn(r)+'" to '+this.name);if(r<t||r>o)throw new TypeError('Passing a number "'+gn(r)+'" from JS side to C/C++ side to an argument of type "'+e+'", which is outside the valid range ['+t+", "+o+"]!");return c?r>>>0:0|r},argPackAdvance:8,readValueFromPointer:xn(e,a,0!==t),K:null})},c:function(n,e,r){function t(n){var e=_;return new o(y,e[1+(n>>=2)],e[n])}var o=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];hn(n,{name:r=sn(r),fromWireType:t,argPackAdvance:8,readValueFromPointer:t},{V:!0})},l:function(n,e){var r="std::string"===(e=sn(e));hn(n,{name:e,fromWireType:function(n){var e=_[n>>2];if(r)for(var t=n+4,o=0;o<=e;++o){var i=n+4+o;if(o==e||0==m[i]){if(t){for(var a=t+(i-t),u=t;!(u>=a)&&m[u];)++u;t=P.decode(m.subarray(t,u))}else t="";if(void 0===c)var c=t;else c+=String.fromCharCode(0),c+=t;t=i+1}}else{for(c=Array(e),o=0;o<e;++o)c[o]=String.fromCharCode(m[n+4+o]);c=c.join("")}return Dn(n),c},toWireType:function(n,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var t="string"==typeof e;t||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||pn("Cannot pass non-string to std::string");var o=(r&&t?function(){for(var n=0,r=0;r<e.length;++r){var t=e.charCodeAt(r);55296<=t&&57343>=t&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++r)),127>=t?++n:n=2047>=t?n+2:65535>=t?n+3:n+4}return n}:function(){return e.length})(),i=Bn(4+o+1);if(_[i>>2]=o,r&&t)!function(n,e,r){var t=m;if(0<r){r=e+r-1;for(var o=0;o<n.length;++o){var i=n.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&n.charCodeAt(++o)),127>=i){if(e>=r)break;t[e++]=i}else{if(2047>=i){if(e+1>=r)break;t[e++]=192|i>>6}else{if(65535>=i){if(e+2>=r)break;t[e++]=224|i>>12}else{if(e+3>=r)break;t[e++]=240|i>>18,t[e++]=128|i>>12&63}t[e++]=128|i>>6&63}t[e++]=128|63&i}}t[e]=0}}(e,i+4,o+1);else if(t)for(t=0;t<o;++t){var a=e.charCodeAt(t);255<a&&(Dn(i),pn("String has UTF-16 code units that do not fit in 8 bits")),m[i+4+t]=a}else for(t=0;t<o;++t)m[i+4+t]=e[t];return null!==n&&n.push(Dn,i),i},argPackAdvance:8,readValueFromPointer:Z,K:function(n){Dn(n)}})},f:function(n,e,r){if(r=sn(r),2===e)var t=W,o=k,i=C,a=function(){return w},u=1;else 4===e&&(t=F,o=R,i=I,a=function(){return _},u=2);hn(n,{name:r,fromWireType:function(n){for(var r,o=_[n>>2],i=a(),c=n+4,f=0;f<=o;++f){var s=n+4+f*e;f!=o&&0!=i[s>>u]||(c=t(c,s-c),void 0===r?r=c:(r+=String.fromCharCode(0),r+=c),c=s+e)}return Dn(n),r},toWireType:function(n,t){"string"!=typeof t&&pn("Cannot pass non-string to C++ string type "+r);var a=i(t),c=Bn(4+a+e);return _[c>>2]=a>>u,o(t,c+4,a+e),null!==n&&n.push(Dn,c),c},argPackAdvance:8,readValueFromPointer:Z,K:function(n){Dn(n)}})},p:function(n,e,r,t,o,i){X[n]={name:sn(e),W:_n(r,t),X:_n(o,i),N:[]}},b:function(n,e,r,t,o,i,a,u,c,f){X[n].N.push({P:sn(e),U:r,S:_n(t,o),T:i,Z:a,Y:_n(u,c),$:f})},z:function(n,e){hn(n,{aa:!0,name:e=sn(e),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},i:vn,A:function(n){if(0===n)return mn(En());var e=Pn[n];return n=void 0===e?sn(n):e,mn(En()[n])},n:function(n){4<n&&(yn[n].M+=1)},q:function(n,r,t,o){n||pn("Cannot use deleted val. handle = "+n),n=yn[n].value;var i=kn[r];if(!i){i="";for(var a=0;a<r;++a)i+=(0!==a?", ":"")+"arg"+a;var u="return function emval_allocator_"+r+"(constructor, argTypes, args) {\n";for(a=0;a<r;++a)u+="var argType"+a+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+a+'], "parameter '+a+'");\nvar arg'+a+" = argType"+a+".readValueFromPointer(args);\nargs += argType"+a+"['argPackAdvance'];\n";i=new Function("requireRegisteredType","Module","__emval_register",u+"var obj = new constructor("+i+");\nreturn __emval_register(obj);\n}\n")(Wn,e,mn),kn[r]=i}return i(n,t,o)},h:function(){L()},t:function(n,e,r){m.copyWithin(n,e,e+r)},e:function(n){n>>>=0;var e=m.length;if(2147483648<n)return!1;for(var r=1;4>=r;r*=2){var t=e*(1+.2/r);t=Math.min(t,n+100663296),0<(t=Math.max(16777216,n,t))%65536&&(t+=65536-t%65536);n:{try{d.grow(Math.min(2147483648,t)-y.byteLength+65535>>>16),S(d.buffer);var o=1;break n}catch(n){}o=void 0}if(o)return!0}return!1},u:function(n,e){var r=0;return Fn().forEach((function(t,o){var i=e+r;for(o=b[n+4*o>>2]=i,i=0;i<t.length;++i)v[o++>>0]=t.charCodeAt(i);v[o>>0]=0,r+=t.length+1})),0},v:function(n,e){var r=Fn();b[n>>2]=r.length;var t=0;return r.forEach((function(n){t+=n.length+1})),b[e>>2]=t,0},m:function(n){l||(e.onExit&&e.onExit(n),x=!0),u(n,new Hn(n))},w:function(){return 0},r:function(){},j:function(n,e,r,t){for(var o=0,i=0;i<r;i++){for(var a=b[e+8*i>>2],u=b[e+(8*i+4)>>2],c=0;c<u;c++){var f=m[a+c],s=In[n];if(0===f||10===f){for(f=0;s[f]&&!(NaN<=f);)++f;f=P.decode(s.subarray?s.subarray(0,f):new Uint8Array(s.slice(0,f))),(1===n?p:h)(f),s.length=0}else s.push(f)}o+=u}return b[t>>2]=o,0},a:d,s:function(){}};!function(){function n(n){e.asm=n.exports,U=e.asm.C,H--,e.monitorRunDependencies&&e.monitorRunDependencies(H),0==H&&(null!==q&&(clearInterval(q),q=null),N&&(n=N,N=null,n()))}function r(e){n(e.instance)}function o(n){return(s||"function"!=typeof fetch?Promise.resolve().then(K):fetch(V,{credentials:"same-origin"}).then((function(n){if(!n.ok)throw"failed to load wasm binary file at '"+V+"'";return n.arrayBuffer()})).catch((function(){return K()}))).then((function(n){return WebAssembly.instantiate(n,i)})).then(n,(function(n){h("failed to asynchronously prepare wasm: "+n),L(n)}))}var i={a:Un};if(H++,e.monitorRunDependencies&&e.monitorRunDependencies(H),e.instantiateWasm)try{return e.instantiateWasm(i,n)}catch(n){return h("Module.instantiateWasm callback failed with error: "+n),!1}(s||"function"!=typeof WebAssembly.instantiateStreaming||G()||"function"!=typeof fetch?o(r):fetch(V,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,i).then(r,(function(n){return h("wasm streaming compile failed: "+n),h("falling back to ArrayBuffer instantiation"),o(r)}))}))).catch(t)}();var jn,Mn=e.___wasm_call_ctors=function(){return(Mn=e.___wasm_call_ctors=e.asm.D).apply(null,arguments)},Dn=e._free=function(){return(Dn=e._free=e.asm.E).apply(null,arguments)},Bn=e._malloc=function(){return(Bn=e._malloc=e.asm.F).apply(null,arguments)},zn=e.___getTypeName=function(){return(zn=e.___getTypeName=e.asm.G).apply(null,arguments)};function Hn(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}function qn(){function n(){if(!jn&&(jn=!0,e.calledRun=!0,!x)){if($(M),$(D),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var n=e.postRun.shift();B.unshift(n)}$(B)}}if(!(0<H)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)z();$(j),0<H||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),n()}),1)):n())}}if(e.___embind_register_native_and_builtin_types=function(){return(e.___embind_register_native_and_builtin_types=e.asm.H).apply(null,arguments)},e.dynCall_jiji=function(){return(e.dynCall_jiji=e.asm.I).apply(null,arguments)},N=function n(){jn||qn(),jn||(N=n)},e.run=qn,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return l=!0,qn(),n.ready},b=function(n,e,r,t){return new(r||(r=Promise))((function(o,i){function a(n){try{c(t.next(n))}catch(n){i(n)}}function u(n){try{c(t.throw(n))}catch(n){i(n)}}function c(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,u)}c((t=t.apply(n,e||[])).next())}))},_=function(n,e){var r,t,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},A="MozJPEG",T="image/jpeg",x="jpg",P={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:3,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75};function E(n,e){return b(this,void 0,void 0,(function(){var r;return _(this,(function(t){switch(t.label){case 0:return g||(g=f(w,"/editor/lib/mozjpeg_enc.wasm")),e=e||P,[4,g];case 1:return r=t.sent(),[2,r.encode(n.data,n.width,n.height,e).buffer]}}))}))}let W,k=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});k.decode();let C=null;function F(){return null!==C&&C.buffer===W.memory.buffer||(C=new Uint8Array(W.memory.buffer)),C}let R=0;let I=null;function S(){return null!==I&&I.buffer===W.memory.buffer||(I=new Int32Array(W.memory.buffer)),I}function O(n,e){try{const f=W.__wbindgen_export_0.value-16;W.__wbindgen_export_0.value=f;var r=function(n,e){const r=e(1*n.length);return F().set(n,r/1),R=n.length,r}(n,W.__wbindgen_malloc),t=R;W.optimise(f,r,t,e);var o=S()[f/4+0],i=S()[f/4+1],a=(u=o,c=i,F().subarray(u/1,u/1+c)).slice();return W.__wbindgen_free(o,1*i),a}finally{W.__wbindgen_export_0.value+=16}var u,c}var U,j=async function n(e){const r={wbg:{}};r.wbg.__wbindgen_throw=function(n,e){throw new Error((r=n,t=e,k.decode(F().subarray(r,r+t))));var r,t},("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:o}=await async function(n,e){if("function"==typeof Response&&n instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(n,e)}catch(e){if("application/wasm"==n.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const r=await n.arrayBuffer();return await WebAssembly.instantiate(r,e)}{const r=await WebAssembly.instantiate(n,e);return r instanceof WebAssembly.Instance?{instance:r,module:n}:r}}(await e,r);return W=t.exports,n.__wbindgen_wasm_module=o,W},M=function(n,e,r,t){return new(r||(r=Promise))((function(o,i){function a(n){try{c(t.next(n))}catch(n){i(n)}}function u(n){try{c(t.throw(n))}catch(n){i(n)}}function c(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,u)}c((t=t.apply(n,e||[])).next())}))},D=function(n,e){var r,t,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},B="OxiPNG",z="image/png",H="png",q={level:3};function N(n,e){return void 0===e&&(e=q),M(this,void 0,void 0,(function(){var r;return D(this,(function(t){switch(t.label){case 0:return[4,s(n,"image/png")];case 1:return[4,p(t.sent())];case 2:return r=t.sent(),U||(U=function(){return M(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,j("/editor/lib/squoosh_oxipng_bg.wasm")];case 1:return n.sent(),[2,O]}}))}))}()),[4,U];case 3:return[2,t.sent()(new Uint8Array(r),e.level).buffer]}}))}))}var L,G={mozJPEG:t,oxiPNG:o},V=function(n){var e,r,t;n=n||{},e||(e=void 0!==n?n:{}),e.ready=new Promise((function(n,e){r=n,t=e}));var o,i={};for(o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);var a,u="";u=0!==(u=self.location.href).indexOf("blob:")?u.substr(0,u.lastIndexOf("/")+1):"",a=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)};var c,f=e.print||console.log.bind(console),s=e.printErr||console.warn.bind(console);for(o in i)i.hasOwnProperty(o)&&(e[o]=i[o]);i=null,e.wasmBinary&&(c=e.wasmBinary),e.noExitRuntime&&e.noExitRuntime,"object"!=typeof WebAssembly&&H("no native wasm support detected");var l,p,h,d,y,v,m,g,w,b,_=!1,A=new TextDecoder("utf8"),T=new TextDecoder("utf-16le");function x(n,e){var r=n>>1;for(e=r+e/2;!(r>=e)&&v[r];)++r;return T.decode(d.subarray(n,r<<1))}function P(n,e,r){if(void 0===r&&(r=2147483647),2>r)return 0;var t=e;r=(r-=2)<2*n.length?r/2:n.length;for(var o=0;o<r;++o)y[e>>1]=n.charCodeAt(o),e+=2;return y[e>>1]=0,e-t}function E(n){return 2*n.length}function W(n,e){for(var r=0,t="";!(r>=e/4);){var o=m[n+4*r>>2];if(0==o)break;++r,65536<=o?(o-=65536,t+=String.fromCharCode(55296|o>>10,56320|1023&o)):t+=String.fromCharCode(o)}return t}function k(n,e,r){if(void 0===r&&(r=2147483647),4>r)return 0;var t=e;r=t+r-4;for(var o=0;o<n.length;++o){var i=n.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&n.charCodeAt(++o)),m[e>>2]=i,(e+=4)+4>r)break}return m[e>>2]=0,e-t}function C(n){for(var e=0,r=0;r<n.length;++r){var t=n.charCodeAt(r);55296<=t&&57343>=t&&++r,e+=4}return e}function F(n){p=n,e.HEAP8=h=new Int8Array(n),e.HEAP16=y=new Int16Array(n),e.HEAP32=m=new Int32Array(n),e.HEAPU8=d=new Uint8Array(n),e.HEAPU16=v=new Uint16Array(n),e.HEAPU32=g=new Uint32Array(n),e.HEAPF32=w=new Float32Array(n),e.HEAPF64=b=new Float64Array(n)}var R=e.INITIAL_MEMORY||16777216;(l=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:R/65536,maximum:32768}))&&(p=l.buffer),R=p.byteLength,F(p);var I,S=[],O=[],U=[],j=[];function M(){var n=e.preRun.shift();S.unshift(n)}var D=0,B=null,z=null;function H(n){throw e.onAbort&&e.onAbort(n),s(n),_=!0,n=new WebAssembly.RuntimeError("abort("+n+"). Build with -s ASSERTIONS=1 for more info."),t(n),n}function q(){var n=N;return String.prototype.startsWith?n.startsWith("data:application/octet-stream;base64,"):0===n.indexOf("data:application/octet-stream;base64,")}e.preloadedImages={},e.preloadedAudios={};var N="imagequant.wasm";if(!q()){var L=N;N=e.locateFile?e.locateFile(L,u):u+L}function G(){try{if(c)return new Uint8Array(c);if(a)return a(N);throw"both async and sync fetching of the wasm failed"}catch(n){H(n)}}function V(n){for(;0<n.length;){var r=n.shift();if("function"==typeof r)r(e);else{var t=r.J;"number"==typeof t?void 0===r.G?I.get(t)():I.get(t)(r.G):t(void 0===r.G?null:r.G)}}}function J(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}var K=void 0;function $(n){for(var e="";d[n];)e+=K[d[n++]];return e}var X={},Y={},Z={};function Q(n){if(void 0===n)return"_unknown";var e=(n=n.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=e&&57>=e?"_"+n:n}function nn(n,e){return n=Q(n),new Function("body","return function "+n+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(e)}function en(n){var e=Error,r=nn(n,(function(e){this.name=n,this.message=e,void 0!==(e=Error(e).stack)&&(this.stack=this.toString()+"\n"+e.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var rn=void 0;function tn(n){throw new rn(n)}var on=void 0;function an(n,e,r){if(r=r||{},!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var t=e.name;if(n||tn('type "'+t+'" must have a positive integer typeid pointer'),Y.hasOwnProperty(n)){if(r.K)return;tn("Cannot register type '"+t+"' twice")}Y[n]=e,delete Z[n],X.hasOwnProperty(n)&&(e=X[n],delete X[n],e.forEach((function(n){n()})))}var un=[],cn=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function fn(n){4<n&&0==--cn[n].H&&(cn[n]=void 0,un.push(n))}function sn(n){switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var e=un.length?un.pop():cn.length;return cn[e]={H:1,value:n},e}}function ln(n){return this.fromWireType(g[n>>2])}function pn(n){if(null===n)return"null";var e=typeof n;return"object"===e||"array"===e||"function"===e?n.toString():""+n}function hn(n,e){switch(e){case 2:return function(n){return this.fromWireType(w[n>>2])};case 3:return function(n){return this.fromWireType(b[n>>3])};default:throw new TypeError("Unknown float type: "+n)}}function dn(n){for(;n.length;){var e=n.pop();n.pop()(e)}}function yn(n,r,t){e.hasOwnProperty(n)?((void 0===t||void 0!==e[n].D&&void 0!==e[n].D[t])&&tn("Cannot register public name '"+n+"' twice"),function(n,r){var t=e;if(void 0===t[n].D){var o=t[n];t[n]=function(){return t[n].D.hasOwnProperty(arguments.length)||tn("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[n].D+")!"),t[n].D[arguments.length].apply(this,arguments)},t[n].D=[],t[n].D[o.I]=o}}(n,n),e.hasOwnProperty(t)&&tn("Cannot register multiple overloads of a function with the same number of arguments ("+t+")!"),e[n].D[t]=r):(e[n]=r,void 0!==t&&(e[n].M=t))}function vn(n,r){var t=-1!=(n=$(n)).indexOf("j")?function(n,r){0<=n.indexOf("j")||H("Assertion failed: getDynCaller should only be called with i64 sigs");var t=[];return function(){t.length=arguments.length;for(var o=0;o<arguments.length;o++)t[o]=arguments[o];return-1!=n.indexOf("j")?t&&t.length?e["dynCall_"+n].apply(null,[r].concat(t)):e["dynCall_"+n].call(null,r):I.get(r).apply(null,t)}}(n,r):I.get(r);return"function"!=typeof t&&tn("unknown function pointer with signature "+n+": "+r),t}var mn=void 0;function gn(n){var e=$(n=In(n));return Rn(n),e}function wn(n,e,r){switch(e){case 0:return r?function(n){return h[n]}:function(n){return d[n]};case 1:return r?function(n){return y[n>>1]}:function(n){return v[n>>1]};case 2:return r?function(n){return m[n>>2]}:function(n){return g[n>>2]};default:throw new TypeError("Unknown integer type: "+n)}}var bn={};function _n(){return"object"==typeof globalThis?globalThis:Function("return this")()}function An(n,e){var r=Y[n];return void 0===r&&tn(e+" has unknown type "+gn(n)),r}for(var Tn={},xn=[null,[],[]],Pn=Array(256),En=0;256>En;++En)Pn[En]=String.fromCharCode(En);K=Pn,rn=e.BindingError=en("BindingError"),on=e.InternalError=en("InternalError"),e.count_emval_handles=function(){for(var n=0,e=5;e<cn.length;++e)void 0!==cn[e]&&++n;return n},e.get_first_emval=function(){for(var n=5;n<cn.length;++n)if(void 0!==cn[n])return cn[n];return null},mn=e.UnboundTypeError=en("UnboundTypeError"),O.push({J:function(){Cn()}});var Wn={o:function(){},p:function(n,e,r,t,o){var i=J(r);an(n,{name:e=$(e),fromWireType:function(n){return!!n},toWireType:function(n,e){return e?t:o},argPackAdvance:8,readValueFromPointer:function(n){if(1===r)var t=h;else if(2===r)t=y;else{if(4!==r)throw new TypeError("Unknown boolean type size: "+e);t=m}return this.fromWireType(t[n>>i])},F:null})},v:function(n,e){an(n,{name:e=$(e),fromWireType:function(n){var e=cn[n].value;return fn(n),e},toWireType:function(n,e){return sn(e)},argPackAdvance:8,readValueFromPointer:ln,F:null})},m:function(n,e,r){r=J(r),an(n,{name:e=$(e),fromWireType:function(n){return n},toWireType:function(n,e){if("number"!=typeof e&&"boolean"!=typeof e)throw new TypeError('Cannot convert "'+pn(e)+'" to '+this.name);return e},argPackAdvance:8,readValueFromPointer:hn(e,r),F:null})},f:function(n,r,t,o,i,a){var u=function(n,e){for(var r=[],t=0;t<n;t++)r.push(m[(e>>2)+t]);return r}(r,t);n=$(n),i=vn(o,i),yn(n,(function(){!function(n,e){var r=[],t={};throw e.forEach((function n(e){t[e]||Y[e]||(Z[e]?Z[e].forEach(n):(r.push(e),t[e]=!0))})),new mn(n+": "+r.map(gn).join([", "]))}("Cannot call "+n+" due to unbound types",u)}),r-1),function(n,e){function r(n){if((n=e(n)).length!==t.length)throw new on("Mismatched type converter count");for(var r=0;r<t.length;++r)an(t[r],n[r])}var t=[];t.forEach((function(e){Z[e]=n}));var o=Array(n.length),i=[],a=0;n.forEach((function(n,e){Y.hasOwnProperty(n)?o[e]=Y[n]:(i.push(n),X.hasOwnProperty(n)||(X[n]=[]),X[n].push((function(){o[e]=Y[n],++a===i.length&&r(o)})))})),0===i.length&&r(o)}(u,(function(t){var o=n,u=n;t=[t[0],null].concat(t.slice(1));var c=i,f=t.length;2>f&&tn("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=null!==t[1]&&!1,l=!1,p=1;p<t.length;++p)if(null!==t[p]&&void 0===t[p].F){l=!0;break}var h="void"!==t[0].name,d="",y="";for(p=0;p<f-2;++p)d+=(0!==p?", ":"")+"arg"+p,y+=(0!==p?", ":"")+"arg"+p+"Wired";u="return function "+Q(u)+"("+d+") {\nif (arguments.length !== "+(f-2)+") {\nthrowBindingError('function "+u+" called with ' + arguments.length + ' arguments, expected "+(f-2)+" args!');\n}\n",l&&(u+="var destructors = [];\n");var v=l?"destructors":"null";for(d="throwBindingError invoker fn runDestructors retType classParam".split(" "),c=[tn,c,a,dn,t[0],t[1]],s&&(u+="var thisWired = classParam.toWireType("+v+", this);\n"),p=0;p<f-2;++p)u+="var arg"+p+"Wired = argType"+p+".toWireType("+v+", arg"+p+"); // "+t[p+2].name+"\n",d.push("argType"+p),c.push(t[p+2]);if(s&&(y="thisWired"+(0<y.length?", ":"")+y),u+=(h?"var rv = ":"")+"invoker(fn"+(0<y.length?", ":"")+y+");\n",l)u+="runDestructors(destructors);\n";else for(p=s?1:2;p<t.length;++p)f=1===p?"thisWired":"arg"+(p-2)+"Wired",null!==t[p].F&&(u+=f+"_dtor("+f+"); // "+t[p].name+"\n",d.push(f+"_dtor"),c.push(t[p].F));if(h&&(u+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),d.push(u+"}\n"),t=function(n){var e=Function;if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=nn(e.name||"unknownFunctionName",(function(){}));return r.prototype=e.prototype,r=new r,(n=e.apply(r,n))instanceof Object?n:r}(d).apply(null,c),p=r-1,!e.hasOwnProperty(o))throw new on("Replacing nonexistant public symbol");return void 0!==e[o].D&&void 0!==p?e[o].D[p]=t:(e[o]=t,e[o].I=p),[]}))},c:function(n,e,r,t,o){function i(n){return n}e=$(e),-1===o&&(o=4294967295);var a=J(r);if(0===t){var u=32-8*r;i=function(n){return n<<u>>>u}}var c=-1!=e.indexOf("unsigned");an(n,{name:e,fromWireType:i,toWireType:function(n,r){if("number"!=typeof r&&"boolean"!=typeof r)throw new TypeError('Cannot convert "'+pn(r)+'" to '+this.name);if(r<t||r>o)throw new TypeError('Passing a number "'+pn(r)+'" from JS side to C/C++ side to an argument of type "'+e+'", which is outside the valid range ['+t+", "+o+"]!");return c?r>>>0:0|r},argPackAdvance:8,readValueFromPointer:wn(e,a,0!==t),F:null})},b:function(n,e,r){function t(n){var e=g;return new o(p,e[1+(n>>=2)],e[n])}var o=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];an(n,{name:r=$(r),fromWireType:t,argPackAdvance:8,readValueFromPointer:t},{K:!0})},i:function(n,e){var r="std::string"===(e=$(e));an(n,{name:e,fromWireType:function(n){var e=g[n>>2];if(r)for(var t=n+4,o=0;o<=e;++o){var i=n+4+o;if(o==e||0==d[i]){if(t){for(var a=t+(i-t),u=t;!(u>=a)&&d[u];)++u;t=A.decode(d.subarray(t,u))}else t="";if(void 0===c)var c=t;else c+=String.fromCharCode(0),c+=t;t=i+1}}else{for(c=Array(e),o=0;o<e;++o)c[o]=String.fromCharCode(d[n+4+o]);c=c.join("")}return Rn(n),c},toWireType:function(n,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var t="string"==typeof e;t||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||tn("Cannot pass non-string to std::string");var o=(r&&t?function(){for(var n=0,r=0;r<e.length;++r){var t=e.charCodeAt(r);55296<=t&&57343>=t&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++r)),127>=t?++n:n=2047>=t?n+2:65535>=t?n+3:n+4}return n}:function(){return e.length})(),i=Fn(4+o+1);if(g[i>>2]=o,r&&t)!function(n,e,r){var t=d;if(0<r){r=e+r-1;for(var o=0;o<n.length;++o){var i=n.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&n.charCodeAt(++o)),127>=i){if(e>=r)break;t[e++]=i}else{if(2047>=i){if(e+1>=r)break;t[e++]=192|i>>6}else{if(65535>=i){if(e+2>=r)break;t[e++]=224|i>>12}else{if(e+3>=r)break;t[e++]=240|i>>18,t[e++]=128|i>>12&63}t[e++]=128|i>>6&63}t[e++]=128|63&i}}t[e]=0}}(e,i+4,o+1);else if(t)for(t=0;t<o;++t){var a=e.charCodeAt(t);255<a&&(Rn(i),tn("String has UTF-16 code units that do not fit in 8 bits")),d[i+4+t]=a}else for(t=0;t<o;++t)d[i+4+t]=e[t];return null!==n&&n.push(Rn,i),i},argPackAdvance:8,readValueFromPointer:ln,F:function(n){Rn(n)}})},h:function(n,e,r){if(r=$(r),2===e)var t=x,o=P,i=E,a=function(){return v},u=1;else 4===e&&(t=W,o=k,i=C,a=function(){return g},u=2);an(n,{name:r,fromWireType:function(n){for(var r,o=g[n>>2],i=a(),c=n+4,f=0;f<=o;++f){var s=n+4+f*e;f!=o&&0!=i[s>>u]||(c=t(c,s-c),void 0===r?r=c:(r+=String.fromCharCode(0),r+=c),c=s+e)}return Rn(n),r},toWireType:function(n,t){"string"!=typeof t&&tn("Cannot pass non-string to C++ string type "+r);var a=i(t),c=Fn(4+a+e);return g[c>>2]=a>>u,o(t,c+4,a+e),null!==n&&n.push(Rn,c),c},argPackAdvance:8,readValueFromPointer:ln,F:function(n){Rn(n)}})},q:function(n,e){an(n,{L:!0,name:e=$(e),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},g:fn,n:function(n){if(0===n)return sn(_n());var e=bn[n];return n=void 0===e?$(n):e,sn(_n()[n])},j:function(n){4<n&&(cn[n].H+=1)},k:function(n,r,t,o){n||tn("Cannot use deleted val. handle = "+n),n=cn[n].value;var i=Tn[r];if(!i){i="";for(var a=0;a<r;++a)i+=(0!==a?", ":"")+"arg"+a;var u="return function emval_allocator_"+r+"(constructor, argTypes, args) {\n";for(a=0;a<r;++a)u+="var argType"+a+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+a+'], "parameter '+a+'");\nvar arg'+a+" = argType"+a+".readValueFromPointer(args);\nargs += argType"+a+"['argPackAdvance'];\n";i=new Function("requireRegisteredType","Module","__emval_register",u+"var obj = new constructor("+i+");\nreturn __emval_register(obj);\n}\n")(An,e,sn),Tn[r]=i}return i(n,t,o)},e:function(){H()},t:function(n,e,r){d.copyWithin(n,e,e+r)},d:function(n){n>>>=0;var e=d.length;if(2147483648<n)return!1;for(var r=1;4>=r;r*=2){var t=e*(1+.2/r);t=Math.min(t,n+100663296),0<(t=Math.max(16777216,n,t))%65536&&(t+=65536-t%65536);n:{try{l.grow(Math.min(2147483648,t)-p.byteLength+65535>>>16),F(l.buffer);var o=1;break n}catch(n){}o=void 0}if(o)return!0}return!1},u:function(){return 0},r:function(){},l:function(n,e,r,t){for(var o=0,i=0;i<r;i++){for(var a=m[e+8*i>>2],u=m[e+(8*i+4)>>2],c=0;c<u;c++){var l=d[a+c],p=xn[n];if(0===l||10===l){for(l=0;p[l]&&!(NaN<=l);)++l;l=A.decode(p.subarray?p.subarray(0,l):new Uint8Array(p.slice(0,l))),(1===n?f:s)(l),p.length=0}else p.push(l)}o+=u}return m[t>>2]=o,0},a:l,s:function(){}};!function(){function n(n){e.asm=n.exports,I=e.asm.w,D--,e.monitorRunDependencies&&e.monitorRunDependencies(D),0==D&&(null!==B&&(clearInterval(B),B=null),z&&(n=z,z=null,n()))}function r(e){n(e.instance)}function o(n){return(c||"function"!=typeof fetch?Promise.resolve().then(G):fetch(N,{credentials:"same-origin"}).then((function(n){if(!n.ok)throw"failed to load wasm binary file at '"+N+"'";return n.arrayBuffer()})).catch((function(){return G()}))).then((function(n){return WebAssembly.instantiate(n,i)})).then(n,(function(n){s("failed to asynchronously prepare wasm: "+n),H(n)}))}var i={a:Wn};if(D++,e.monitorRunDependencies&&e.monitorRunDependencies(D),e.instantiateWasm)try{return e.instantiateWasm(i,n)}catch(n){return s("Module.instantiateWasm callback failed with error: "+n),!1}(c||"function"!=typeof WebAssembly.instantiateStreaming||q()||"function"!=typeof fetch?o(r):fetch(N,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,i).then(r,(function(n){return s("wasm streaming compile failed: "+n),s("falling back to ArrayBuffer instantiation"),o(r)}))}))).catch(t)}();var kn,Cn=e.___wasm_call_ctors=function(){return(Cn=e.___wasm_call_ctors=e.asm.x).apply(null,arguments)},Fn=e._malloc=function(){return(Fn=e._malloc=e.asm.y).apply(null,arguments)},Rn=e._free=function(){return(Rn=e._free=e.asm.z).apply(null,arguments)},In=e.___getTypeName=function(){return(In=e.___getTypeName=e.asm.A).apply(null,arguments)};function Sn(){function n(){if(!kn&&(kn=!0,e.calledRun=!0,!_)){if(V(O),V(U),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var n=e.postRun.shift();j.unshift(n)}V(j)}}if(!(0<D)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)M();V(S),0<D||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),n()}),1)):n())}}if(e.___embind_register_native_and_builtin_types=function(){return(e.___embind_register_native_and_builtin_types=e.asm.B).apply(null,arguments)},e.dynCall_jiji=function(){return(e.dynCall_jiji=e.asm.C).apply(null,arguments)},z=function n(){kn||Sn(),kn||(z=n)},e.run=Sn,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Sn(),n.ready},J=function(n,e,r,t){return new(r||(r=Promise))((function(o,i){function a(n){try{c(t.next(n))}catch(n){i(n)}}function u(n){try{c(t.throw(n))}catch(n){i(n)}}function c(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,u)}c((t=t.apply(n,e||[])).next())}))},K=function(n,e){var r,t,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},$={zx:0,maxNumColors:256,dither:1};function X(n,e){return void 0===e&&(e=$),J(this,void 0,void 0,(function(){var r,t;return K(this,(function(o){switch(o.label){case 0:return L||(L=f(V,"/editor/lib/imagequant.wasm")),[4,L];case 1:return r=o.sent(),t=e.zx?r.zx_quantize(n.data,n.width,n.height,e.dither):r.quantize(n.data,n.width,n.height,e.maxNumColors,e.dither),[2,new ImageData(t,n.width,n.height)]}}))}))}var Y=function(n,e,r,t){return new(r||(r=Promise))((function(o,i){function a(n){try{c(t.next(n))}catch(n){i(n)}}function u(n){try{c(t.throw(n))}catch(n){i(n)}}function c(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,u)}c((t=t.apply(n,e||[])).next())}))},Z=function(n,e){var r,t,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function Q(n,e){return Y(this,void 0,void 0,(function(){var e,r,t,o,i;return Z(this,(function(a){switch(a.label){case 0:return[4,d(n)];case 1:return e=a.sent(),[4,m(n)];case 2:return[4,X(a.sent())];case 3:return r=a.sent(),t=function(n){switch(n){case"image/png":return"oxiPNG";case"image/jpeg":return"mozJPEG";default:return""}}(e),(o=G[t])?[4,o.encode(r)]:[3,5];case 4:return i=a.sent(),[2,new File([i],n.name.replace(/.[^.]*$/,"."+o.extension),{type:o.mimeType})];case 5:console.error("lack of corresponding encoder!"),a.label=6;case 6:return[2]}}))}))}}])}));